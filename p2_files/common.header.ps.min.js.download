var getElementsByClassName=function(e,t,a){return(getElementsByClassName=document.getElementsByClassName?function(e,t,a){for(var n,r=(a=a||document).getElementsByClassName(e),o=t?new RegExp("\\b"+t+"\\b","i"):null,i=[],s=0,l=r.length;s<l;s+=1)n=r[s],o&&!o.test(n.nodeName)||i.push(n);return i}:document.evaluate?function(e,t,a){t=t||"*",a=a||document;for(var n,r,o=e.split(" "),i="",s="http://www.w3.org/1999/xhtml",l=document.documentElement.namespaceURI===s?s:null,c=[],d=0,u=o.length;d<u;d+=1)i+="[contains(concat(' ', @class, ' '), ' "+o[d]+" ')]";try{n=document.evaluate(".//"+t+i,a,l,0,null)}catch(e){n=document.evaluate(".//"+t+i,a,null,0,null)}for(;r=n.iterateNext();)c.push(r);return c}:function(e,t,a){t=t||"*",a=a||document;for(var n,r,o=e.split(" "),i=[],s="*"===t&&a.all?a.all:a.getElementsByTagName(t),l=[],c=0,d=o.length;c<d;c+=1)i.push(new RegExp("(^|\\s)"+o[c]+"(\\s|$)"));for(var u=0,m=s.length;u<m;u+=1){n=s[u],r=!1;for(var g=0,f=i.length;g<f&&(r=i[g].test(n.className));g+=1);r&&l.push(n)}return l})(e,t,a)};function isIE(){var n=window.navigator.userAgent,i=n.indexOf("MSIE "),e=n.indexOf("Trident/");return 0<i||0<e}function MM_goToURL(){var i,args=MM_goToURL.arguments;for(document.MM_returnValue=!1,i=0;i>args.length-1;i+=2)eval(args[i]+".location='"+args[i+1]+"'")}function mOvr(e,t){e.contains(event.fromElement)||(e.style.cursor="hand",e.bgColor=t)}function mOut(e,t){e.contains(event.toElement)||(e.style.cursor="default",e.bgColor=t)}function mClk(e){"TD"==event.srcElement.tagName&&e.children.tags("A")[0].click()}function MM_preloadImages(){var e=document;if(e.images){e.MM_p||(e.MM_p=new Array);var t,a=e.MM_p.length,n=MM_preloadImages.arguments;for(t=0;t<n.length;t++)0!=n[t].indexOf("#")&&(e.MM_p[a]=new Image,e.MM_p[a++].src=n[t])}}function MM_findObj(e,t){var a,n,r;for(t=t||document,0<(a=e.indexOf("?"))&&parent.frames.length&&(t=parent.frames[e.substring(a+1)].document,e=e.substring(0,a)),!(r=t[e])&&t.all&&(r=t.all[e]),n=0;!r&&n<t.forms.length;n++)r=t.forms[n][e];for(n=0;!r&&t.layers&&n<t.layers.length;n++)r=MM_findObj(e,t.layers[n].document);return!r&&t.getElementById&&(r=t.getElementById(e)),r}function MM_swapImage(){var e,t,a=0,n=MM_swapImage.arguments;for(document.MM_sr=new Array,e=0;e<n.length-2;e+=3)null!=(t=MM_findObj(n[e]))&&((document.MM_sr[a++]=t).oSrc||(t.oSrc=t.src),t.src=n[e+2])}function MM_swapImgRestore(){var e,t,a=document.MM_sr;for(e=0;a&&e<a.length&&(t=a[e])&&t.oSrc;e++)t.src=t.oSrc}function MM_showHideLayers(){var e,t,a,n=MM_showHideLayers.arguments;for(e=0;e<n.length-2;e+=3)null!=(a=MM_findObj(n[e]))&&(t=n[e+2],a.style&&(a=a.style,t="show"==t?"visible":(t="hide")?"hidden":t),a.visibility=t)}function errorsuppressor(){return!0}function MM_displayStatusMsg(e){status=e,document.MM_returnValue=!0}function MM_timelineGoto(tmLnName,fNew,numGotos){var i,j,tmLn,props,keyFrm,sprite,numKeyFr,firstKeyFr,lastKeyFr,propNum,theObj;if(null==document.MM_Time&&MM_initTimelines(),tmLn=document.MM_Time[tmLnName],null!=numGotos)if(null==tmLn.gotoCount)tmLn.gotoCount=1;else if(tmLn.gotoCount++>=numGotos)return void(tmLn.gotoCount=0);for(jmpFwd=fNew>tmLn.curFrame,i=0;i<tmLn.length;i++)if(sprite=jmpFwd?tmLn[i]:tmLn[tmLn.length-1-i],"s"==sprite.charAt(0)){if(numKeyFr=sprite.keyFrames.length,firstKeyFr=sprite.keyFrames[0],lastKeyFr=sprite.keyFrames[numKeyFr-1],jmpFwd&&fNew<firstKeyFr||!jmpFwd&&lastKeyFr<fNew)continue;for(keyFrm=1;keyFrm<numKeyFr&&fNew>=sprite.keyFrames[keyFrm];keyFrm++);for(j=0;j<sprite.values.length;j++)props=sprite.values[j],propNum=numKeyFr==props.length?keyFrm-1:Math.min(Math.max(0,fNew-firstKeyFr),props.length-1),null!=sprite.obj&&(null==props.prop2?sprite.obj[props.prop]=props[propNum]:sprite.obj[props.prop2][props.prop]=props[propNum])}else"b"==sprite.charAt(0)&&fNew==sprite.frame&&eval(sprite.value);tmLn.curFrame=fNew,0==tmLn.ID&&eval("MM_timelinePlay(tmLnName)")}function MM_timelinePlay(tmLnName,myID){var i,j,tmLn,props,keyFrm,sprite,numKeyFr,firstKeyFr,propNum,theObj,firstTime=!1;if(null==document.MM_Time&&MM_initTimelines(),tmLn=document.MM_Time[tmLnName],null==myID&&(myID=++tmLn.ID,firstTime=!0),myID==tmLn.ID)for(setTimeout('MM_timelinePlay("'+tmLnName+'",'+myID+")",tmLn.delay),fNew=++tmLn.curFrame,i=0;i<tmLn.length;i++){if(sprite=tmLn[i],"s"==sprite.charAt(0)){if(sprite.obj&&(numKeyFr=sprite.keyFrames.length,firstKeyFr=sprite.keyFrames[0],fNew>=firstKeyFr&&fNew<=sprite.keyFrames[numKeyFr-1]))for(keyFrm=1,j=0;j<sprite.values.length;j++)if(props=sprite.values[j],numKeyFr!=props.length)null==props.prop2?sprite.obj[props.prop]=props[fNew-firstKeyFr]:sprite.obj[props.prop2][props.prop]=props[fNew-firstKeyFr];else{for(;keyFrm<numKeyFr&&fNew>=sprite.keyFrames[keyFrm];)keyFrm++;!firstTime&&fNew!=sprite.keyFrames[keyFrm-1]||(null==props.prop2?sprite.obj[props.prop]=props[keyFrm-1]:sprite.obj[props.prop2][props.prop]=props[keyFrm-1])}}else"b"==sprite.charAt(0)&&fNew==sprite.frame&&eval(sprite.value);fNew>tmLn.lastFrame&&(tmLn.ID=0)}}function MM_initTimelines(){var e="Netscape"==navigator.appName;e&&parseInt(navigator.appVersion),e&&parseInt(navigator.appVersion);for(document.MM_Time=new Array(1),document.MM_Time[0]=new Array(3),document.MM_Time.Timeline1=document.MM_Time[0],document.MM_Time[0].MM_Name="Timeline1",document.MM_Time[0].fps=15,document.MM_Time[0][0]=new String("behavior"),document.MM_Time[0][0].frame=35,document.MM_Time[0][0].value="MM_showHideLayers('AboutUsIE','','hide')",document.MM_Time[0][1]=new String("behavior"),document.MM_Time[0][1].frame=2,document.MM_Time[0][1].value="MM_showHideLayers('AboutUsIE','','show')",document.MM_Time[0][2]=new String("behavior"),document.MM_Time[0][2].frame=1,document.MM_Time[0][2].value="MM_timelineGoto('Timeline1','35')",document.MM_Time[0].lastFrame=35,i=0;i<document.MM_Time.length;i++)document.MM_Time[i].ID=null,document.MM_Time[i].curFrame=0,document.MM_Time[i].delay=1e3/document.MM_Time[i].fps}function expand(e,t){window.navigator.appName;var a,n,r=window.navigator.userAgent.toLowerCase();a=r.indexOf("msie")+1,n=r.indexOf("firefox")+1;var o=0;"Microsoft Internet Explorer"!=r&&(o=12);var i,s=document.getElementById(t),l=document.getElementById(e),c=l.offsetLeft-13;i=0==a&&0==n?-1!=r.indexOf("netscape6")?l.offsetTop+20:l.offsetTop+104:l.offsetTop+101;var d=l.offsetWidth-o;l.style.backgroundColor="#2965ad",s.style.top=i+"px",s.style.left=c+"px",s.style.width=d+"px",s.style.position="absolute",s.style.visibility="visible",s.style.display="block"}function collapse(e,t){var a=document.getElementById(t);document.getElementById(e).style.backgroundColor="#2965ad",a.style.position="static",a.style.visibility="hidden",a.style.display="none"}function collapseAll(){var e,t=document.getElementById("AboutUsIE").getElementsByTagName("div");for(i=0;i<t.length;i++)(e=t[i]).style.visibility="hidden",e.style.display="none"}function openWin(e){window.open("https://www.crystalgraphics.com/Photos/License.asp","newWin","width=800,height=600,status=yes,resizable=yes,scrollbars=yes").focus()}function closeWindow(){win.close()}function trim(e){for(var t=0,a=e.length,n=e.length,r=0;r<n&&" "==e.charAt(r);r++)t=r+1;for(var o=n-1;0<=o&&" "==e.charAt(o);o--)a=o;return e.slice(t,a)}function setGetParameterToUrl(e,t,a){var n,r=location.hash;return 0<=(e=e.replace(r,"")).indexOf("?"+t+"=")?(e=e.substring(0,e.indexOf("?"+t))+"?"+t+"="+a+(n=0<=(n=(n=e.substring(e.indexOf("?"+t))).substring(n.indexOf("=")+1)).indexOf("&")?n.substring(n.indexOf("&")):""))+r:0<=e.indexOf("&"+t+"=")?(e=e.substring(0,e.indexOf("&"+t))+"&"+t+"="+a+(n=0<=(n=(n=e.substring(e.indexOf("&"+t))).substring(n.indexOf("=")+1)).indexOf("&")?n.substring(n.indexOf("&")):""))+r:(e+=(0<=e.indexOf("?")?"&":"?")+t+"="+a)+r}function setGetParameter(e,t){return setGetParameterToUrl(window.location.href,e,t)}function ellipsizeTextBox(n){var e=document.getElementById(n),t=e.getAttribute("data-delay")?e.getAttribute("data-delay"):1e3;setTimeout(function(){var e=document.getElementById(n);e.setAttribute("data-full-description",e.innerHTML);for(var t=e.getAttribute("data-height")?e.getAttribute("data-height"):e.offsetHeight,a=e.innerHTML.split(" ");e.scrollHeight>t;)a.pop(),e.innerHTML=a.join(" ")+' <span class="more-dots" id="ellips_text_more_'+n+'"> ...</span>';addListener("click","enlargeTextBox","ellips_text_more_"+n,"ellips_text_more_"+n)},t)}function enlargeTextBox(e,t){var a=document.getElementById(e).parentElement;return a.innerHTML=a.getAttribute("data-full-description"),a.style.maxHeight="100%",t.preventDefault&&t.preventDefault(),t.returnValue=!1}window.onerror=errorsuppressor;var hslRgb={hslToRgb:function(e,t,a){var n,r,o;if(0==t)n=r=o=a;else{function i(e,t,a){return a<0&&(a+=1),1<a&&(a-=1),a<1/6?e+6*(t-e)*a:a<.5?t:a<2/3?e+(t-e)*(2/3-a)*6:e}var s=a<.5?a*(1+t):a+t-a*t,l=2*a-s;n=i(l,s,e+1/3),r=i(l,s,e),o=i(l,s,e-1/3)}return[Math.round(255*n),Math.round(255*r),Math.round(255*o)]},rgbToHsl:function(e,t,a){e/=255,t/=255,a/=255;var n,r,o=Math.max(e,t,a),i=Math.min(e,t,a),s=(o+i)/2;if(o==i)n=r=0;else{var l=o-i;switch(r=.5<s?l/(2-o-i):l/(o+i),o){case e:n=(t-a)/l+(t<a?6:0);break;case t:n=(a-e)/l+2;break;case a:n=(e-t)/l+4}n/=6}return[n,r,s]}};function scrollTo(t,e,a){var n=t.scrollTop,r=e-n,o=0;Math.easeInOutQuad=function(e,t,a,n){return(e/=n/2)<1?a/2*e*e+t:-a/2*(--e*(e-2)-1)+t};var i=function(){o+=20;var e=Math.easeInOutQuad(o,n,r,a);t.scrollTop=e,o<a&&setTimeout(i,20)};i()}var searchSubmit=function(){function c(e,t){var a=document.getElementById("designer_template_subscriber_alert");return a&&(a.style.display="block",cookiesFunc.setCookie("dtsadnsa",1,3650),ajaxRequest.doHiddenRequest("/favorites/dtypedialog?value=show",!1)),addListener("click","subscriberAlertOk","designer_subscriber_alert_ok","designer_subscriber_alert_ok"),addListener("click","subscriberAlertCancel","designer_subscriber_alert_cancel","designer_subscriber_alert_cancel"),!!t&&(t.preventDefault&&t.preventDefault(),t.returnValue=!1)}return{sendSubmit:function(e,t){var a=document.forms[e],n=""==a.ss||null==a.ss||"undefined"==a.ss?a.keyword:a.ss,r=n.value;r=""+r,n.value=trim(r);var o=n.getAttribute("data-caption");if(""==r||null==r||"undefined"==r||o&&r==o)return alert("Please enter one or more search words"),t.preventDefault&&t.preventDefault(),t.returnValue=!1;var i=n.getAttribute("data-type");if(r=(r=r.replace(/ /g,"+"))&&0!==r.length?r:"all","photo"==i){a.ss=r;var s=(a.getAttribute("data-default-action")?a.getAttribute("data-default-action"):a.action)+(a.category&&a.category.value?a.category.value+"/":"")+(a.color&&a.color.value?a.color.value+"/":"")+r;return window.location.href=s,t.preventDefault&&t.preventDefault(),t.returnValue=!1}if("template"!=i)return a.referrer&&(a.referrer.value=a.referrer&&document.referrer?document.referrer:""),a.submit(),t.preventDefault&&t.preventDefault(),t.returnValue=!1;s=(a.getAttribute("data-default-action")?a.getAttribute("data-default-action"):a.action)+(a.category&&a.category.value?a.category.value+"/":"")+(a.color&&a.color.value?a.color.value+"/":"")+r;var l=decodeURIComponent((new RegExp("[?|&]plugin=([^&;]+?)(&|#|;|$)").exec(location.search)||[,""])[1].replace(/\+/g,"%20"))||void 0;return s+=null!=l&&"y"==l?(-1==s.indexOf("?")?"?":"&")+"plugin="+l:"",a.action=s,a.submit(),t.preventDefault&&t.preventDefault(),t.returnValue=!1},advancedSearch:function(e,t){var a=document.forms[e],n=a.search_form_term.value;n=trim(n=""+n);var r=(""==a.ss||null==a.ss||"undefined"==a.ss?a.keyword:a.ss).getAttribute("data-caption");return(""==n||null==n||"undefined"==n||r&&n==r)&&(n=""),window.location.href="/search/advanced/"+n,t.preventDefault&&t.preventDefault(),t.returnValue=!1},searchParamCheckboxClick:function(e,t){var a=document.getElementById("dtype_custom"),n=document.getElementById("dtype_powerplugs"),r=document.getElementById("b_moving"),o=document.getElementById("b_static");if("dtype_custom_adv"!=e&&"dtype_powerplugs_adv"!=e&&"b_moving_adv"!=e&&"b_static_adv"!=e||(a=document.getElementById("dtype_custom_adv"),n=document.getElementById("dtype_powerplugs_adv"),r=document.getElementById("b_moving_adv"),o=document.getElementById("b_static_adv")),!(a&&n&&r&&o))return!1;switch(document.getElementById(e).name){case"dtype_custom":if(a.checked)if(document.getElementById("designer_template_subscriber_alert"))return c(e,t);if(!n.checked&&!a.checked)return alert("We require that Powerplugs and Static be checked if Custom and Moving are not checked."),t.preventDefault&&t.preventDefault(),t.returnValue=!1;a.checked&&(o.checked=!0);break;case"dtype_powerplugs":if(!n.checked&&!a.checked)return alert("We require that Powerplugs and Static be checked if Custom and Moving are not checked."),t.preventDefault&&t.preventDefault(),t.returnValue=!1;r.disabled=!n.checked,n.checked||(o.checked=!0);break;case"b_moving":case"b_static":if(!o.checked&&!r.checked)return alert("We require that Powerplugs and Static be checked if Custom and Moving are not checked."),t.preventDefault&&t.preventDefault(),t.returnValue=!1}},searchParamSelectboxClick:function(e,t){var a=document.getElementById("dtype"),n=document.getElementById("b"),r=document.getElementById("format_adv");if(!a||!n||!r)return!1;switch(document.getElementById(e).id){case"dtype":if("custom"==a.value||"crystal"==a.value||"any"==a.value)if(document.getElementById("designer_template_subscriber_alert"))return c(e,t);if(("custom"==a.value||"crystal"==a.value)&&"moving"==n.value){alert("We require that Powerplugs and Static be checked if Custom and Moving are not checked.");var o=a.getAttribute("data-previous-val");return a.value=o||"any",!1}for(var i=n.options,s=0;s<i.length;s++)i[s].disabled=!1,"custom"!=a.value&&"crystal"!=a.value||"moving"==n.value||(i[s].disabled="moving"==i[s].value);break;case"b":if(("custom"==a.value||"crystal"==a.value)&&"moving"==n.value){alert("We require that Powerplugs and Static be checked if Custom and Moving are not checked.");var l=n.getAttribute("data-previous-val");return n.value=l||"any",!1}for(i=a.options,s=0;s<i.length;s++)i[s].disabled=!1,"custom"!=a.value&&"crystal"!=a.value&&"moving"==n.value&&(i[s].disabled="custom"==i[s].value||"crystal"==i[s].value)}a.setAttribute("data-previous-val",a.value),n.setAttribute("data-previous-val",n.value)},subscriberAlertOk:function(e,t){var a=document.getElementById("dtype_custom");a&&(a.checked=!0);var n=document.getElementById("dtype_custom_adv");n&&(n.checked=!0),closeModalDialog(e,t),ajaxRequest.doHiddenRequest("/favorites/dtypedialog?value=ok",!1)},subscriberAlertCancel:function(e,t){closeModalDialog(e,t),ajaxRequest.doHiddenRequest("/favorites/dtypedialog?value=cancel",!1);var a=document.getElementById("dtype");if(a&&"checkbox"!==a.type)for(i=0;i<a.length;i++)if("powerplugs"==a.options[i].value){a.value=a.options[i].value;break}if(window.location.href.indexOf("/search/advanced")<0){if(!cookiesFunc.checkCookiesEnabled())return!1;cookiesFunc.setCookie("tpl_dtype","powerplugs",3650),cookiesFunc.setCookie("is_user_changed_tpl_dtype","12",365);var n=window.location.href.replace(/\&(page|pg)\=[0-9]+/gim,"");n=(n=n.replace(/\?(page|pg)\=[0-9]+&/gim,"?")).replace(/\?(page|pg)\=[0-9]+$/gim,""),window.location.href=n}return!1},enableCrystalTemplatesButtonClick:function(e,t){if(t&&(t.preventDefault&&t.preventDefault(),t.returnValue=!1),!cookiesFunc.checkCookiesEnabled()||"powerplugs"!==cookiesFunc.getCookie("tpl_dtype"))return!1;cookiesFunc.setCookie("tpl_dtype","",0),cookiesFunc.setCookie("is_user_changed_tpl_dtype","11",365);var a=window.location.href.replace(/\&(page|pg)\=[0-9]+/gim,"");return a=(a=a.replace(/\?(page|pg)\=[0-9]+&/gim,"?")).replace(/\?(page|pg)\=[0-9]+$/gim,""),window.location.href=a,!1},customOptionForSubscribers:c}}();function sendSubmit(e,t){searchSubmit.sendSubmit(e,t)}function advancedSearch(e,t){searchSubmit.advancedSearch(e,t)}function searchParamCheckboxClick(e,t){searchSubmit.searchParamCheckboxClick(e,t)}function searchParamSelectboxClick(e,t){searchSubmit.searchParamSelectboxClick(e,t)}function subscriberAlertOk(e,t){searchSubmit.subscriberAlertOk(e,t)}function subscriberAlertCancel(e,t){searchSubmit.subscriberAlertCancel(e,t)}function enableCrystalTemplatesButtonClick(e,t){searchSubmit.enableCrystalTemplatesButtonClick(e,t)}function logoutLinksClick(e,t){ajaxRequest.doHiddenRequest("/subscription/logout/",!1);for(var a=getElementsByClassName("sign_out",!1,!1),n=0;n<a.length;n++)a[n].style.opacity="0",a[n].style.zIndex="1";return setTimeout(function(){for(var e=0;e<a.length;e++)a[e].style.display="none"},600),setTimeout(function(){for(var e=getElementsByClassName("sign_in",!1,!1),t=0;t<e.length;t++)e[t].style.visibility="visible",e[t].style.opacity="1"},800),showAlert("You are signed out.",4),setTimeout(function(){getElementsByClassName("download-btn",!1,!1).length&&window.location.reload(!0)},5e3),t.preventDefault&&t.preventDefault(),t.returnValue=!1}var addPlaceHolder=function(){function n(e){var t=e.target||e.srcElement,a=t.getAttribute("data-caption");t.placeholder="",t.value==a?(t.value="",t.style.color="#999999"):t.style.color="#000000"}function r(e){var t=e.target||e.srcElement,a=t.getAttribute("data-caption");t.placeholder=a,""==t.value||t.value==a?(t.value=a,t.style.color="#999999"):t.style.color="#000000"}function o(e){var t=e.target||e.srcElement,a=t.getAttribute("data-caption");t.value==a?(t.select(),t.style.color="#999999"):t.style.color="#000000"}return{onFocus:n,onBlur:r,onKeyup:o,checkPlaceholderSupport:function(){for(var e="",t=getElementsByClassName("with_place_holder"),a=0;a<t.length;a++){e=t[a].getAttribute("data-caption"),"placeholder"in document.createElement("input")?(t[a].addEventListener("focus",function(e){(e.target||e.srcElement).placeholder=""},!1),t[a].addEventListener("blur",function(e){var t=e.target||e.srcElement,a=t.getAttribute("data-caption");t.placeholder=a},!0)):(t[a].value=""!=t[a].value?t[a].value:e,t[a].style.color="#999999",t[a].addEventListener?(t[a].addEventListener("focus",n,!0),t[a].addEventListener("focus",r,!0),t[a].addEventListener("focus",o,!0)):(t[a].attachEvent("onfocus",n),t[a].attachEvent("onblur",r),t[a].attachEvent("onkeyup",o)))}}}}();function toggle_visibility(e,t){var a;if(null==(a=document.getElementById(e))||null==a)return t.preventDefault&&t.preventDefault(),t.returnValue=!1;0==a.style.maxHeight||"0px"==a.style.maxHeight?(a.style.overflow="visible",a.style.maxHeight="1000px"):(a.style.maxHeight=0,a.style.overflow="hidden"),"addtocarttable_outer"==e&&((a=document.getElementById("addtocarttable_expand")).style.opacity="0.1",toggle_visibility("addtocarttable_expand",t));return t.preventDefault&&t.preventDefault(),t.returnValue=!1}function showAlert(e,t){var a=document.getElementById("alert_message_text_crystal");if(null==a)return!1;a.innerHTML=e;var n=document.getElementById("alert_message_crystal");if(null==n)return!1;n.style.display="block";var r=document.getElementById("alert_message_outer_container");r&&(r.style.display="block"),t*=1e3,setTimeout(function(){hideAlert()},t)}function hideAlert(){var e=getElementsByClassName("opaco","div",!1);if(e.length)for(var t=0;t<e.length;t++)e[t].style.display="none";var a=document.getElementById("alert_message_crystal");if(null==a)return!1;a.style.display="none"}function showProgress(e){showProgressWithTimer(e,1e4)}function showProgressWithTimer(e,t){var a=document.getElementById("loading_crystal"),n=document.getElementById("cachedData");if(null==a||n)return!1;var r=document.getElementById("alert_message_outer_container");null!=r&&(r.style.display="block"),e?(a.style.display="block",r.style.display="block",setTimeout(function(){a.style.display="none",r.style.display="none"},t)):(a.style.display="none",r.style.display="none")}function showStartupMessage(){var e=document.getElementById("alert_message_text");if(void 0!==e&&null!=e){var t=e.innerHTML;if(""!=t){var a=e.getAttribute("data-delay");showAlert(t,a=a||5)}}}var ajaxRequest=function(){var r=this;function a(e,t){r.requestProvider(e,t,"GET",!1).requestSend()}return this.isIE8=!!window.XDomainRequest,this.isIE8&&navigator&&navigator.appVersion&&(-1!=navigator.appVersion.indexOf("MSIE 7.")||-1!=navigator.appVersion.indexOf("MSIE 8."))&&(this.isIE8=!1),r.requestProvider=this.isIE8?function(e,t,a,n){var r=this;return r.request=new window.XDomainRequest,r.requestSend=function(){r.request.onload=function(){t(request.responseText)};try{r.request.withCredentials=!0}catch(e){}r.request.open(a,e,!0),n&&"POST"==a?(r.request.setRequestHeader("Content-type","application/x-www-form-urlencoded"),r.request.send(n)):r.request.send()},this}:function(e,t,a,n){var r=this;return r.request=new XMLHttpRequest,r.requestSend=function(){r.request.onreadystatechange=function(){4==r.request.readyState&&t(r.request.responseText)};try{r.request.withCredentials=!0}catch(e){}r.request.open(a,e,!0),n&&"POST"==a?(r.request.setRequestHeader("Content-type","application/x-www-form-urlencoded"),r.request.send(n)):r.request.send()},this},{doRequest:function(e,t){showProgress(!0),a(e,t)},doHiddenRequest:a,doPostRequest:function(e,t,a){var n=r.requestProvider(e,t,"POST",a);showProgress(!0),n.requestSend()}}}(),tabs={switchTab:function(e,t){if(!document.getElementById(e))return!1;var a=getElementsByClassName("tab_label","label",!1);if(a.length)for(var n=0;n<a.length;n++)a[n].className="tab_label";var r=getElementsByClassName("tab_content","div",!1);if(r.length)for(n=0;n<r.length;n++)r[n].style.maxWidth="0",r[n].style.display="none";activeTabContent=document.getElementById(e+"_content"),activeTabContent.style.display="block",setTimeout(function(){activeTabContent.style.maxWidth="10000px"},100)}};function switchTabs(e,t){tabs.switchTab(e,t)}function closeModalDialog(e,t){t.stopPropagation&&t.stopPropagation(),t.cancelBubble=!0,hideAlert();var a=getElementsByClassName("alert_message_outer_container","div",!1);if(a.length)for(var n=0;n<a.length;n++)a[n].style.display="none";return!1}var notificationModal=function(){var i=!1;return{notificationModalDismiss:function(e,t){t.stopPropagation&&t.stopPropagation(),t.cancelBubble=!0,hideAlert();var a=getElementsByClassName("alert_message_outer_container","div",!1);if(a.length)for(var n=0;n<a.length;n++)a[n].style.display="none";var r=document.getElementById("notification_counter");if(r&&r.innerHTML){var o=parseInt(r.innerHTML);o&&(r.innerHTML=o-1),o-1<1&&(i=!0,r.style.display="none")}return!1},noticeModalLinkClick:function(e,t){t.preventDefault&&t.preventDefault(),t.returnValue=!1;var a=document.getElementById("notification_counter");if(i||!a||"none"==a.style.display){var n=document.getElementById("notification_modal_no_notifications");if(n)return!(n.style.display="block")}var r=document.getElementById("subscribers_message_container");return r&&(r.style.display="block"),!1}}}();function notificationModalDismiss(e,t){notificationModal.notificationModalDismiss(e,t)}function noticeModalLinkClick(e,t){notificationModal.noticeModalLinkClick(e,t)}function modifyImage(){var e=new Image;e.src=document.getElementById("BigImg").src,document.getElementById("BigImgDiv").style.height=e.height-20+"px",document.getElementById("BigImgDiv").style.width=e.width+"px",document.getElementById("BigImgDiv").style.overflow="hidden"}var imageSwitcher=function(){function c(e){var t=e.getAttribute("data-preview-number");if(!t)return!1;for(var a=new Array,n=1;n<=t;n++){var r=e.getAttribute("data-preview-"+n);if(!r)break;var o=new Image;o.src=r,a.push(o)}return a}return{switchImage:function(e,t){var a=document.getElementById("rotate_slides"),n=a.getAttribute("data-counter"),r=a.getAttribute("data-preview-number");if(!(n&&n&&r&&c(a)))return!1;n=isNaN(n)?0:n,n=r<=(n=parseInt(n)+1)?0:n,t.target&&t.target.getAttribute("data-image-switcher")&&"prev"==t.target.getAttribute("data-image-switcher")&&(n=(n=(n=parseInt(n)-2)<-1?r-2:n)<0?r-1:n);var o=document.getElementById(e);o&&o.getAttribute("data-preview-switcher")&&(n=o.getAttribute("data-preview-switcher")),o&&o.getAttribute("data-preview-switcher")||(t.preventDefault&&t.preventDefault(),t.returnValue=!1);for(var i=getElementsByClassName("rotate_slides"),s=0;s<i.length;s++){var l=c(i[s]);i[s].src=l[n].src,i[s].setAttribute("data-counter",n)}return function(e){for(var t=getElementsByClassName("title_body"),a=0;a<t.length;a++)t[a].className=t[a].className.replace(/\bCONTAINER_TS\b/i,""),t[a].className=t[a].className.replace(/\bCONTAINER_BS\b/i,""),t[a].className=t[a].className+(0<e?" container_bs":" container_ts")}(n),function(e){var t=document.getElementById("rotate_slides_title");if(t){t.style.opacity="0.1";var a=t.getAttribute("data-title-"+e);setTimeout(function(){t.innerHTML=a||"",t.style.opacity="1"},800)}}(n),function(e){for(var t=getElementsByClassName("image_swithcher"),a=0;a<t.length;a++)t[a].className=t[a].className.replace(/\bACTIVE\b/i,""),(0<e||"0"===e||0===e)&&e==t[a].getAttribute("data-preview-switcher")&&(t[a].className=t[a].className+" active")}(n),function(e){for(var t=getElementsByClassName("rotate_slides"),a=0;a<t.length;a++)t[a].parentElement&&(t[a].parentElement.className=t[a].parentElement.className.replace(/SLIDE\_NUMBER\_[0-9]+/gim,"slide_number_"+e))}(n),"function"==typeof preloadImages&&preloadImages(),!1},zoomImg:function(e,t){t.preventDefault&&t.preventDefault(),t.returnValue=!1;var a=document.getElementById("zoomed_container");if(!a)return!1;a.style.display="block","function"==typeof preloadImages&&preloadImages();var n=document.getElementById("opaco_closable");return!!n&&!(n.style.display="block")},refreshCurrentImage:function(){var e=document.getElementById("rotate_slides");if(!e)return!1;for(var t=e.getAttribute("data-counter"),a=getElementsByClassName("rotate_slides"),n=0;n<a.length;n++){var r=c(a[n]);a[n].src=r[t].src}}}}();function switchImage(e,t){return imageSwitcher.switchImage(e,t)}function zoomImg(e,t){return imageSwitcher.zoomImg(e,t)}var imagesPreloader=function(){var a=[];function n(e){for(var t=e.getAttribute("data-counter"),a=function(e){var t=e.getAttribute("data-preview-number");if(!t)return!1;for(var a=new Array,n=1;n<=t;n++){var r=e.getAttribute("data-preview-"+n);if(!r)break;var o=new Image;o.src=r,a.push(o)}return a}(e),n=1;n<=2;n++)a[parseInt(t)+n]&&r(a[parseInt(t)+n].src)}function r(e){if(a[e])return!1;var t=document.createElement("img");t.src=e,document.getElementById("images_preloader").appendChild(t),a[e]=e}return{preloadImagesAfterLoad:function(){setTimeout(function(e){var t=document.getElementById("images_preloader");if(!t||!t.childNodes.length)return!1;for(var a=0;a<t.childNodes.length;a++)if(t.childNodes[a]&&t.childNodes[a].nodeName&&"DIV"==t.childNodes[a].nodeName){var n=t.childNodes[a].getAttribute("data-img-url");n&&r(n)}},5e3)},preloadImages:function(){var e,t,a=document.getElementById("zoomed_container");return a&&a.style.display&&"block"==a.style.display?!!(e=document.getElementById("rotate_slides_2"))&&n(e):!!(t=document.getElementById("rotate_slides"))&&n(t)}}}();function preloadImages(){return imagesPreloader.preloadImages()}var templates=function(){var n=this;function s(e){if(showProgress(!1),"added"==e){var t=getElementsByClassName("favorite_template_btn",!1,!1);if(t.length)for(var a=0;a<t.length;a++)t[a].style.color="#aaa";showAlert("Added to favorites",2)}else showAlert("removed"==e?"Removed from favorites":"Error",2)}function r(e){if(showProgress(!1),n.downloadParams)if(1<=e.indexOf("pluginOk"))window.location.href="https://www.crystalgraphics.com/powerpoint/templates.download.complete.html"+n.downloadParams.dlqs;else{t(e);window.location.href="https://www.crystalgraphics.com/powerpoint/templates.download.asp?errorMode=y&product="+n.downloadParams.prod+"&en="+n.downloadParams.errorNumber}}function t(e){var t=e.indexOf("STARTERRORCODE");t+=14;var a=e.indexOf("ENDERRORCODE"),n=e.substring(t,a);return 0<(n=parseInt(n))&&n<=10||(n="8"),n}function o(e){showProgress(!1),showAlert("Added to cart",2)}return this.downloadParams=!1,{getErrorNumber:t,doFavorite:function(e,t){var a=document.getElementById(e);null!==a&&(e=a.getAttribute("data-templatename"));var n=a.getAttribute("data-favorited"),r=null!=n&&"0"!=n&&0!=n,o=!!a.getAttribute("data-product-type")&&a.getAttribute("data-product-type");if(r&&null!=a.tagName&&"A"===a.tagName)return t.preventDefault&&t.preventDefault(),t.returnValue=!1;var i="/favorites/favorite?ajax=y&product="+e+"&product_type="+o;return i=r?i+"&type=remove":i,ajaxRequest.doRequest(i,s),null!=a.tagName&&"A"===a.tagName&&(t.preventDefault&&t.preventDefault(),t.returnValue=!1),a.setAttribute("data-favorited",r?"0":"1"),!1},doDownload:function(e,t){var a=function(e){var t=document.getElementById(e);return null!==t&&(this.prod=t.getAttribute("data-templatename"),this.pimode=t.getAttribute("data-pimode"),this.en=t.getAttribute("data-en"),this.ws=t.getAttribute("data-ws")?t.getAttribute("data-ws"):"",this.dlfile=t.getAttribute("data-dlfile"),this.dlqs="?plugin=y&pimode="+pimode+"&product="+prod+"&en="+en+(ws?"&ws="+ws:""),this.url="https://www.crystalgraphics.com/powerpoint/"+dlfile+dlqs,this.url="/templates/download"+dlqs,n.downloadParams=this)}(e);return a&&ajaxRequest.doRequest(a.url,r),t.preventDefault&&t.preventDefault(),t.returnValue=!1},doAddToCart:function(e,t){var a=document.getElementById(e).getAttribute("href");return ajaxRequest.doRequest(a,o),t.preventDefault&&t.preventDefault(),t.returnValue=!1}}}();function templateFavorite(e,t){templates.doFavorite(e,t)}function templateDownload(e,t){templates.doDownload(e,t)}function templateAddToCart(e,t){templates.doAddToCart(e,t)}var customizableDnld=function(){function l(e){if(showProgress(!1),"added"==e){var t=getElementsByClassName("favorite_template_btn",!1,!1);if(t.length)for(var a=0;a<t.length;a++)t.style.color="#aaa";showAlert("Added to favorites",2)}else showAlert("removed"==e?"Removed from favorites":"Error",2)}function c(e){var t="",a=!1,n=getElementsByClassName("download_customizable_btn",!1,!1);n.length&&n[0]&&(a=n[0]),(a=a||document.getElementById(e))&&(t+="&image_id="+a.getAttribute("data-img-id"),t+="&design_id="+a.getAttribute("data-design-id"),t+="&title_position="+a.getAttribute("data-title-position"),t+="&zoom="+a.getAttribute("data-zoom"),t+="&widescreen="+a.getAttribute("data-widescreen"),t+="&confirmed="+a.getAttribute("data-confirmed")),a.getAttribute("data-description")&&(console.log(a.getAttribute("data-description")),t+="&desc="+a.getAttribute("data-description"));var r=document.getElementById("big_img_placeholder");r?(t+="&position_top="+r.style.top,t+="&position_left="+r.style.left):(t+="&position_top="+a.getAttribute("data-position_top"),t+="&position_left="+a.getAttribute("data-position_left"));var o=document.getElementsByName("form_aspect_blck");if(o)for(var i=0,s=o.length;i<s;i++)if(o[i].checked){t+="&ratio="+o[i].value;break}return t}return{getErrorNumber:function(e){var t=e.indexOf("STARTERRORCODE");t+=14;var a=e.indexOf("ENDERRORCODE"),n=e.substring(t,a);return 0<(n=parseInt(n))&&n<=10||(n="8"),n},doFavorite:function(e,t){var a=document.getElementById(e);if(!a)return!1;var n=a.getAttribute("data-favorited"),r=null!=n&&"0"!=n&&0!=n;if(r&&null!=a.tagName&&"A"===a.tagName)return t.preventDefault&&t.preventDefault(),t.returnValue=!1;var o=c(e,t),i=document.getElementById(e).getAttribute("data-templatename"),s=document.getElementById(e).getAttribute("data-target-url");return s=s||"/favorites/favorite?ajax=y&product_type=custom&product="+i,s=r?s+"&type=remove":s,ajaxRequest.doPostRequest(s,l,o),null!=a.tagName&&"A"===a.tagName&&(t.preventDefault&&t.preventDefault(),t.returnValue=!1),a.setAttribute("data-favorited",r?"0":"1"),!1},doDownload:function(e,t){var a=c(e,t),n=document.getElementById(e).getAttribute("data-target-url");return n=n||"/templates.how-to-order?ajax=y&product="+e,window.location.href=n+(1<n.indexOf("?")?a:"?"+a.substring(1,a.length-1)),t.preventDefault&&t.preventDefault(),t.returnValue=!1}}}();function customizableFavorite(e,t){return customizableDnld.doFavorite(e,t)}function customizableDownload(e,t){return customizableDnld.doDownload(e,t)}function addToCartEventHandler(e,t){var a=document.getElementById(e);if(!a||!a.getAttribute("data-ga-percent")||!a.getAttribute("data-ga-label"))return!1;window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-2610266-1","auto"),ga("send",{hitType:"event",eventCategory:"add-to-cart",eventAction:"click",eventLabel:a.getAttribute("data-ga-label"),eventValue:a.getAttribute("data-ga-percent")})}var feedback=function(){var l=this;function c(e){if(showProgress(!1),1<=e.indexOf("resultOk")){var t=getElementsByClassName("favorite_template_btn",!1,!1);if(t.length)for(var a=0;a<t.length;a++)t.style.color="#aaa";showAlert("Thank you",5);var n=document.getElementById("feedback_container");null!=n&&(setTimeout(function(){n.style.maxHeight="0"},3e3),setTimeout(function(){n.style.display="none"},5e3))}else{var r=!0;if(1<=e.indexOf("errorText"))try{var o=JSON.parse(e);o.errorText&&(showAlert(o.errorText,3),r=!1)}catch(e){}r&&showAlert("Error occurred during adding your feedback.",3)}return!1}function o(){l.answer="";var e=getElementsByClassName("feedbackAnswerBtn","a",!1);if(e.length)for(var t=0;t<e.length;t++)e[t].style.borderColor="#999",e[t].style.color="initial";document.getElementById("form_feedback_text").style.borderColor="#999"}return{setAnswer:function(e){l.answer=e},doFeedback:function(e,t){var a=document.getElementById(e),n=a.getAttribute("data-answer"),r=a.getAttribute("href");return"#"!=r&&1<r.length&&1<n.length&&ajaxRequest.doRequest(r,c),a.setAttribute("href","#"),t.preventDefault&&t.preventDefault(),t.returnValue=!1},submitFeedback:function(e,t){var a="/feedback";if(1<a.length){var n=document.getElementById("form_feedback_text"),r=encodeURIComponent(n.value),o="form_backurl="+encodeURIComponent(window.location.href)+"&"+n.name+"="+r,i=document.getElementById("form_feedback_question");null!=i&&null!=i.value&&(o+="&form_feedback_question="+i.value),l.answer&&(o+="&form_answer="+l.answer);var s=document.getElementById("form_feedback_email");null!=s&&null!=s.value&&(o+="&form_feedback_email="+s.value),ajaxRequest.doPostRequest(a,c,o)}return t.preventDefault&&t.preventDefault(),t.returnValue=!1},textShow:function(e,t){var a=document.getElementById(e),n=a.getAttribute("data-answer"),r=document.getElementById("feedback_text");return null==r||null==r||(r.style.maxHeight=0,r.style.overflow="hidden",feedback_link_message.style.maxHeight=0,feedback_link_message.style.overflow="hidden",setTimeout(function(){r.style.overflow="visible",r.style.maxHeight="1000px",o();var e=document.getElementById("form_feedback_text");a.style.borderColor="#BFDEFF","yes"==n&&(l.answer="yes",e.style.borderColor="#BFDEFF",a.style.borderColor="#BFDEFF",a.style.color="#BFDEFF"),"no"==n&&(l.answer="no",e.style.borderColor="#FFBFBF",a.style.borderColor="#FFBFBF",a.style.color="#FFBFBF")},800)),t.preventDefault&&t.preventDefault(),t.returnValue=!1},textHide:function(){var e=document.getElementById("feedback_text");return e.style.maxHeight="0",e.style.overflow="hidden",setTimeout(function(){var e=document.getElementById("feedback_link_message");e.style.overflow="visible",e.style.maxHeight="1000px"},800),o(),evt.preventDefault&&evt.preventDefault(),evt.returnValue=!1}}}();function feedbackAnswer(e,t){return feedback.textShow(e,t)}function feedbackTextHide(e,t){return feedback.textHide(e,t)}function sendFeedbackAnswer(e,t){var a=document.getElementById(e).getAttribute("data-answer");return null!=a&&1<a.length&&feedback.setAnswer(a),feedback.submitFeedback(e,t)}var cookiesFunc={checkCookiesEnabled:function(){return!!document.cookie},getCookie:function(e){for(var t=e+"=",a=document.cookie.split(";"),n=0;n<a.length;n++){for(var r=a[n];" "==r.charAt(0);)r=r.substring(1);if(0==r.indexOf(t))return r.substring(t.length,r.length)}return""},setCookie:function(e,t,a){var n=new Date;n.setTime(n.getTime()+24*a*60*60*1e3);var r=n.toUTCString();document.cookie=e+"="+t+";expires="+r+";path=/;domain=crystalgraphics.com;secure",document.cookie=e+"="+t+";expires="+r+";path=/;domain=*.crystalgraphics.com;secure",document.cookie=e+"="+t+";expires="+r+";path=/;secure"}},mobileCheck=function(){this.desktopVersionCookieName="is_desktop_device",this.minScreenWidth=1260;var e=this;return{onStartMobileCheck:function(){cookiesFunc.checkCookiesEnabled&&screen.width>e.minScreenWidth&&(""==cookiesFunc.getCookie(e.desktopVersionCookieName)?cookiesFunc.setCookie(e.desktopVersionCookieName,"1stVisit",365):cookiesFunc.setCookie(e.desktopVersionCookieName,"true",365))}}}(),aspectRatio=function(){function i(e){var t=document.getElementById("search_template_format");t&&(t.value=e);var a=document.getElementById("aspect_choose_checkbox");a&&(a.checked=!1);var n=document.getElementById("aspect_format_label");n&&(e="16-9"==e?": Widescreen (16:9)":": Traditional (4:3)",n.innerHTML=e)}function s(e){var t=document.getElementsByName("form_aspect_blck");if(t)for(var a=0,n=t.length;a<n;a++)if(t[a].checked=!1,t[a].value==e){t[a].checked=!0;break}var r=document.getElementsByName("form_aspect_blck_2");if(r)for(a=0,n=r.length;a<n;a++)if(r[a].checked=!1,r[a].value==e){r[a].checked=!0;break}return!!(t&&t.length||r&&r.length)}function l(e){var t=document.getElementById("format");t&&(t.checked="16-9"==e);var a=document.getElementById("f");a&&(a.value=e)}return{saveAspectRatio:function(e,t){if(0<=e.indexOf("traditional")||0<=e.indexOf("widescreen")){var a=0<=e.indexOf("widescreen")?"16-9":"4-3";return cookiesFunc.setCookie("tpl_format",a,365),i(a),customEvents.setAspectImagesEvt(e,t),s(a),l(a),customState.centerBigImgIfCenteredBefore(a),"16-9"==a&&"function"==typeof checkNetScalingFactors&&checkNetScalingFactors(),!1}var n=document.getElementsByName("form_aspect");if(n)for(var r=0,o=n.length;r<o;r++)if(n[r].checked){cookiesFunc.setCookie("tpl_format",n[r].value,365),i(n[r].value),s(n[r].value);break}return customState.centerBigImgIfCenteredBefore(),"function"==typeof checkNetScalingFactors&&checkNetScalingFactors(),!1},setSearchToolFormat:function(e,t){var a=document.getElementById(e),n=a.checked?"16-9":"4-3";if(i(n),l(n),document.getElementById("notification_modal_no_alternate_format")||(cookiesFunc.setCookie("tpl_format",n,365),customEvents.setAspectImagesEvt(e,t)),s(n)&&(customImages.setAspectImages(a.checked),customState.customDesignApplyColors(!1,!1,!1,!1)),customState&&"function"==typeof customState.centerBigImgIfCenteredBefore&&customState.centerBigImgIfCenteredBefore(a.checked),"16-9"==n&&"function"==typeof checkNetScalingFactors&&checkNetScalingFactors(),function(e,t,a){var n=document.getElementById("notification_modal_no_alternate_format");n&&0<n.className.indexOf(a)&&(n.style.display="block",modalNoAlternateFormatCloseBtn=document.getElementById("notification_modal_no_alternate_format_close_2"),modalNoAlternateFormatCloseBtn&&modalNoAlternateFormatCloseBtn.focus());var r=document.getElementById("notification_modal_has_alternate_format");if(!r)return;if(r.value)return window.location.href=r.value;window.location.reload(!0)}(0,0,n),document.getElementById("is_search_alternate_images")&&customImages)return customImages.setAspectImagesPlato5("16-9"==n),void window.location.reload(!0);var r=document.getElementById("is_search_alternate_images_url");r&&r.value&&(window.location.pathname&&window.location.pathname==r.value?window.location.reload(!0):window.location.href=r.value)},setAspectWideScreenFormatSearchTool:l}}();function setSearchToolFormat(e,t){aspectRatio.setSearchToolFormat(e,t)}var customUrl=function(){function a(e){return e=e.replace(/\_ws$/i,"")}function u(e,t,a,n,r,o){return"custom-"+(e?e+"-":"")+t+"-"+a+"-"+n+(r?"-"+r:"")+(o?"_ws":"")}function n(e){var t=e.match(/\-(\d*)\-(\d*)\-(\d*)$/i);return t&&t[3]&&0<t[3]?t[3]:!!((t=e.match("/-(d*)-(d*)-(d*)_ws$/si"))&&t[3]&&0<t[3])&&t[3]}function m(e){var t;if(n(e=a(e))){if((t=e.match(/custom\-(.*)\-(\w*)\-(\d*)\-(\d*)\-(\d*)$/i))&&t[1])return t[1]}else if((t=e.match(/custom\-(.*)\-(\w*)\-(\d*)\-(\d*)$/i))&&t[1])return t[1];return!1}function g(e){var t;if(n(e=a(e))){if((t=e.match(/\-(\w*)\-(\d*)\-(\d*)\-(\d*)$/i))&&t[1])return t[1]}else if((t=e.match(/\-(\w*)\-(\d*)\-(\d*)$/i))&&t[1])return t[1];return!1}function f(e){var t;if(n(e=a(e))){if((t=e.match(/\-(\d*)\-(\d*)\-(\d*)$/i))&&t[1]&&0<t[1])return t[1]}else if((t=e.match(/\-(\d*)\-(\d*)$/i))&&t[1]&&0<t[1])return t[1];return!1}function p(e){var t;if(n(e=a(e))){if((t=e.match(/\-(\w*)\-(\d*)\-(\d*)\-(\d*)$/i))&&t[3]&&1<t[3])return t[3]}else if((t=e.match(/\-(\w*)\-(\d*)\-(\d*)$/i))&&t[3]&&1<t[3])return t[3];return!1}function h(e){if(n(e=a(e))){var t=e.match(/\-(\d*)$/i);if(t&&t[1])return t[1]}return!1}function v(e){return e.match("/-(d*)-(d*)_ws$/si",e)}function y(e){var t=e.match(/\/templates\/view\/(.*)(\/|$|#|\?)/i),a=!(!t||!t[1])&&t[1];return a&&-1<a.indexOf("#")&&(a=!!a&&a.substring(0,a.indexOf("#"))),a&&-1<a.indexOf("?")&&(a=!!a&&a.substring(0,a.indexOf("?"))),a}return{replaceImageIdInUrl:function(e,t){var a,n,r,o,i,s,l,c=y(e),d=(n=t,r=m(a=c),o=f(a),i=p(a),s=h(a),l=v(a),u(r,n,o,i,s,l));return e.replace(c,d)},replaceDesignInUrl:function(e,t){if(!e)return!1;var a=y(e);if(!a)return!1;var n,r,o,i,s,l,c,d=(r=t,o=m(n=a),i=g(n),s=p(n),l=h(n),c=v(n),u(o,i,r,s,l,c));return!!d&&e.replace(a,d)},replaceColorSchemeIdInUrl:function(e,t){if(!e)return!1;var a=y(e);if(!a)return!1;var n,r,o,i,s,l,c,d=(r=t,o=m(n=a),i=g(n),s=f(n),l=h(n),c=v(n),u(o,i,s,r,l,c));return!!d&&e.replace(a,d)},replaceVersionNumberInUrl:function(e,t){var a,n,r,o,i,s,l,c=y(e),d=(n=t,r=m(a=c),o=g(a),i=f(a),s=p(a),l=v(a),u(r,o,i,s,n,l));return e.replace(c,d)},replaceWideScreenInUrl:function(e,t){var a,n,r,o,i,s,l,c=y(e),d=(a=c,n=wideScreen,r=m(a),o=g(a),i=f(a),s=p(a),l=h(a),u(r,o,i,s,l,n));return e.replace(c,d)}}}(),customEvents={setAspectImagesEvt:function(e,t){var a=0<=e.indexOf("widescreen")||0<=e.indexOf("16-9")||0<=e.indexOf("16:9")||document.getElementById(e)&&document.getElementById(e).value&&"16-9"==document.getElementById(e).value&&document.getElementById(e).checked;customImages.setAspectImages(a),customState.setWideScreenValueForDownloadBtn(1==a?1:0),customState.pushStateOperation(window.location.href,"widescreen"),customState.customDesignApplyColors(!1,!1,!1,!1)},switchCustomDesignEvt:function(e,t){var a=document.getElementById(e).getAttribute("data-switch-design"),n=document.getElementById(e).getAttribute("data-switch-backdrop"),r=document.getElementById(e).getAttribute("data-switch-artwork");customState.customDesignApplyParams(a,!1,!1,n,r);var o=document.getElementById(e).getAttribute("data-color-ts-artwork-by-design")?document.getElementById(e).getAttribute("data-color-ts-artwork-by-design"):document.getElementById(e).getAttribute("data-color-bs-artwork-by-design"),i=document.getElementById(e).getAttribute("data-color-bs-title-backdrop"),s=document.getElementById(e).getAttribute("data-color-bs-title-backdrop-s3");return customState.customDesignApplyColors(o,!1,i,s),t.preventDefault&&t.preventDefault(),t.returnValue=!1},switchCustomTitlePositionEvt:function(e,t){var a=document.getElementById("custom_title_position");if(!a||!a.value)return!1;var n=a.options[a.selectedIndex].getAttribute("data-title-position-color-palette"),r=a.value;customState.customDesignApplyParams(!1,r,n,!1,!1);var o=a.options[a.selectedIndex].getAttribute("data-title-position-pure-color");o&&customState.customDesignApplyColors(!1,o,!1,!1),customImages.setCurrentBackdropTransparency(),imageSwitcher.switchImage("image_swithcher_2_0",t)}};function saveAspectRatioBtnClick(e,t){return closeModalDialog(e,t),aspectRatio.saveAspectRatio(e,t),customEvents.setAspectImagesEvt(e,t),!0}function switchCustomDesignEvt(e,t){return customEvents.switchCustomDesignEvt(e,t)}function switchCustomTitlePositionEvt(e,t){customEvents.switchCustomTitlePositionEvt(e,t)}var customState=function(){var a=!1;function i(e,t){a==t&&(0<=t.indexOf("position_button_")||"zoom"==t)||"center"==t?n(e):function(e){if(!e||!history||!history.pushState)return;history.pushState&&e&&history.pushState(r(),null,window.location.href);sessionStorage&&sessionStorage.setItem(e,JSON.stringify(r()))}(e),a=t}function n(e){if(!e||!history||!history.replaceState)return!1;history.replaceState&&e&&history.replaceState(r(),null,e),sessionStorage&&sessionStorage.setItem(e,JSON.stringify(r()))}function t(e){if(!e)return!1;if(!e["data-last_uniq-id"]||!lastUniqId||e["data-last_uniq-id"]!=lastUniqId){if("undefined"!==e["data-widescreen"]&&(u(1==e["data-widescreen"]?1:0),customImages.setAspectImages(1==e["data-widescreen"]?1:0),aspectRatio.setAspectWideScreenFormatSearchTool(1==e["data-widescreen"]?"16-9":"4-3"),"undefined"!==e["data-is-image-centered"]&&e["data-is-image-centered"]&&v(1==e["data-widescreen"]?1:0)),e["data-design-id"]){var t=!!e["data-color-id"]&&e["data-color-id"];t&&(function(e){var t=getElementsByClassName("favorite_customizable_btn",!1,!1);if(t.length)for(var a=0;a<t.length;a++)t[a].setAttribute("data-color-id",e)}(t),s(t),"function"==typeof window.setColorPalleteToTitle&&setColorPalleteToTitle(t));var a=!!e["data-title-position"]&&e["data-title-position"];a&&document.getElementById("custom_title_position")&&(document.getElementById("custom_title_position").value=a);var n=!!e["data-switch-artwork"]&&e["data-switch-artwork"],r=!!e["data-backdrop"]&&e["data-backdrop"];r&&document.getElementById("custom_backdrop_filter")&&(document.getElementById("custom_backdrop_filter").value=r),l(e["data-design-id"]),d(a),s(t),c(r),m(n),g(h()),customImages.customDesignApply(e["data-design-id"],a,t,r,n),p(!1,!1,!1,!1)}if(e["data-zoom"]&&sliderControl&&sliderControl.updateSliderValues){var o=sliderControl.calcPlaceholderZoom(e["data-zoom"]);sliderControl.updateSliderValues(o)}void 0!==e["position-top"]&&changeImagePosition&&changeImagePosition.setY&&changeImagePosition.setY(e["position-top"]),void 0!==e["position-left"]&&changeImagePosition&&changeImagePosition.setX&&changeImagePosition.setX(e["position-left"])}}function s(e){var t=getElementsByClassName("download_customizable_btn",!1,!1);if(t.length)for(var a=0;a<t.length;a++)t[a].setAttribute("data-color-id",e)}function l(e){var t=getElementsByClassName("download_customizable_btn",!1,!1);if(t.length&&e)for(var a=0;a<t.length;a++)t[a].setAttribute("data-design-id",e)}function c(e){var t=getElementsByClassName("download_customizable_btn",!1,!1);if(t.length&&e)for(var a=0;a<t.length;a++)t[a].setAttribute("data-backdrop",e)}function d(e){var t=getElementsByClassName("download_customizable_btn",!1,!1);if(t.length&&e)for(var a=0;a<t.length;a++)t[a].setAttribute("data-title-position",e)}function u(e){var t=getElementsByClassName("download_customizable_btn",!1,!1);if(t.length)for(var a=0;a<t.length;a++)t[a].setAttribute("data-widescreen",e)}function m(e){var t=getElementsByClassName("download_customizable_btn",!1,!1);if(t.length)for(var a=0;a<t.length;a++)t[a].setAttribute("data-switch-artwork",e)}function g(e){var t=getElementsByClassName("download_customizable_btn",!1,!1);if(t.length)for(var a=0;a<t.length;a++)t[a].setAttribute("data-color-ts-title-backdrop",e||"")}function f(){var e=getElementsByClassName("download_customizable_btn",!1,!1);if(e.length&&e[0])return e[0].getAttribute("data-title-position")}function p(e,t,a,n){e=e||function(){var e=getElementsByClassName("download_customizable_btn",!1,!1);if(e.length&&e[0])return e[0].getAttribute("data-color-artwork")}(),t=t||h(),a=a||function(){var e=getElementsByClassName("download_customizable_btn",!1,!1);if(e.length&&e[0])return e[0].getAttribute("data-color-bs-title-backdrop")}(),n=n||function(){var e=getElementsByClassName("download_customizable_btn",!1,!1);if(e.length&&e[0])return e[0].getAttribute("data-color-bs-title-backdrop-slide-3")}(),function(e){var t=getElementsByClassName("download_customizable_btn",!1,!1);if(t.length)for(var a=0;a<t.length;a++)t[a].setAttribute("data-color-artwork",e||"")}(e),g(t),function(e){var t=getElementsByClassName("download_customizable_btn",!1,!1);if(t.length)for(var a=0;a<t.length;a++)t[a].setAttribute("data-color-bs-title-backdrop",e||"")}(a),function(e){var t=getElementsByClassName("download_customizable_btn",!1,!1);if(t.length)for(var a=0;a<t.length;a++)t[a].setAttribute("data-color-bs-title-backdrop-slide-3",e||"")}(n),customImages.customDesignApplyColors(e,t,a,n)}function h(){var e,t=f();return t&&(e=document.getElementById("custom_title_position"))&&e.options&&e.options[t-1]&&e.options[t-1].getAttribute("data-title-position-pure-color")||!1}function r(){var e=getElementsByClassName("download_customizable_btn",!1,!1);if(e.length)for(var t=0;t<e.length;t++){var a=e[t].getAttribute("data-img-id"),n=e[t].getAttribute("data-design-id"),r=e[t].getAttribute("data-backdrop"),o=e[t].getAttribute("data-title-position"),i=e[t].getAttribute("data-color-id"),s=e[t].getAttribute("data-zoom"),l="1"===e[t].getAttribute("data-widescreen"),c=e[t].getAttribute("data-switch-artwork"),d=document.getElementById("big_img_placeholder"),u=!!d&&parseFloat(d.style.top.replace(/\%$/,"")),m=!!d&&parseFloat(d.style.left.replace(/\%$/,"")),g=!1;return"undefined"!=typeof changeImagePosition&&void 0!==changeImagePosition.getIsCentered&&"function"==typeof changeImagePosition.getIsCentered&&(g=changeImagePosition.getIsCentered()),{"data-img-id":a,"data-design-id":n,"data-backdrop":r,"data-title-position":o,"data-color-id":i,"data-zoom":s,"data-widescreen":l,"position-top":u,"position-left":m,"data-switch-artwork":c,"data-is-image-centered":g}}}function v(e){"undefined"!=typeof sliderControl&&void 0!==sliderControl.resetSlider&&"function"==typeof sliderControl.resetSlider&&sliderControl.resetSlider(e),"undefined"!=typeof changeImagePosition&&void 0!==changeImagePosition.refreshCenter&&"function"==typeof changeImagePosition.refreshCenter&&changeImagePosition.refreshCenter(e),customState.pushStateOperation(window.location.href,"center")}return{setWideScreenValueForDownloadBtn:u,pushStateOperation:i,onpopstate:function(e){"scrollRestoration"in history&&(history.scrollRestoration="manual"),e&&e.state&&t(e.state)},replaceState:n,loadCustomParameters:t,centerBigImgIfCenteredBefore:v,customDesignApplyColors:p,customDesignApplyParams:function(e,t,a,n,r){e=e||function(){var e=getElementsByClassName("download_customizable_btn",!1,!1);if(e.length&&e[0])return e[0].getAttribute("data-design-id")}(),t=t||f(),a=a||function(){var e=getElementsByClassName("download_customizable_btn",!1,!1);if(e.length&&e[0])return e[0].getAttribute("data-color-id")}(),n=n||function(){var e=getElementsByClassName("download_customizable_btn",!1,!1);if(e.length&&e[0])return e[0].getAttribute("data-backdrop")}(),r=r||function(){var e=getElementsByClassName("download_customizable_btn",!1,!1);if(e.length&&e[0])return e[0].getAttribute("data-switch-artwork")}(),l(e),d(t),s(a),c(n),m(r);var o=0<window.location.href.indexOf("#")?window.location.href.substr(0,window.location.href.indexOf("#")):window.location.href;customImages.customDesignApply(e,t,a,n,r),i(o,"design")}}}(),customImages=function(){function d(e,t){return t?e.replace("/std/","/ws/"):e.replace("/ws/","/std/")}function u(){return!1}function v(){if(!addEventListener||"function"!=typeof replaceDesignTitle)return!1;var e=!1,t=getElementsByClassName("custom_img","img",!1);if(t.length)for(var a=0;a<t.length;a++)t[a].complete||(e||(showProgress(!0),e=!0),t[a].addEventListener("load",n),t[a].addEventListener("error",n))}function n(){var e=getElementsByClassName("custom_img","img",!1);if(e.length)for(var t=0;t<e.length;t++)if(!e[t].complete)return!1;showProgress(!1)}function r(e,t){if(!e||null==e)return!1;var a=JSON.parse(e);l("ts-art",t,a),l("bs-art",t,a)}function o(e,t){if(!e||null==e)return!1;l("ts-bkd",t,JSON.parse(e))}function i(e,t){if(!e||null==e)return!1;l("bs-title-bkd",t,JSON.parse(e))}function s(e,t){if(!e||null==e)return!1;l("bs-title-bkd-s3",t,JSON.parse(e))}function l(e,t,a){switch(t){case 1:if((r=getElementsByClassName(e+" custom_color_img_priority_1","img",!1)).length)for(var n=0;n<r.length;n++)imageEdit.replaceColor(r[n],a);break;case 2:if((r=getElementsByClassName(e+" custom_color_img_priority_2","img",!1)).length)for(n=0;n<r.length;n++)imageEdit.replaceColorWithDelay(r[n],a,2e3);break;case 3:if((r=getElementsByClassName(e,"img",!1)).length)for(n=0;n<r.length;n++)if(!(0<r[n].className.indexOf("custom_color_img_priority_1")||0<r[n].className.indexOf("custom_color_img_priority_2"))){r[n].src;imageEdit.replaceColorWithDelay(r[n],a,2100)}break;default:var r;if((r=getElementsByClassName(e,"img",!1)).length)for(n=0;n<r.length;n++){r[n].src;imageEdit.replaceColor(r[n],a)}}}function y(){var e=document.getElementById("custom_title_position");if(!e||!e.value||!e.options)return!1;var t=e.options[e.selectedIndex].getAttribute("data-backdrop-transparency");if(t)for(var a=getElementsByClassName("backdrop_transparency_ts","img",!1),n=0;n<a.length;n++)a[n].style.opacity=t}function b(e,t){return t?e.replace(/-ts\_(.*)-([0-9]{1})-(text|bkd).png/gim,"-ts_$1-"+t+"-$3.png"):e}function _(e,t){return t?e.replace(/-[0-9]+-/gim,"-"+t+"-"):e}return{setAspectImages:function(e){var t=getElementsByClassName("custom_img","img",!1);if(t.length){u(t),v();for(var a=0;a<t.length;a++)if(!(0<=t[a].className.indexOf("skip_switch_ratio"))){var n=t[a].getAttribute("data-default-src")?t[a].getAttribute("data-default-src"):t[a].src,r=d(n,e);t[a].setAttribute("data-default-src",r),t[a].src=n!=r?r:t[a].src,imageSwitcher.refreshCurrentImage();var o=t[a].getAttribute("data-preview-number");if(o)for(var i=1;i<=o;i++){var s=t[a].getAttribute("data-preview-"+i);if(!s)break;s=d(s,e),t[a].setAttribute("data-preview-"+i,s)}}}var l=getElementsByClassName("aspect_ratio_img",!1,!1);if(l.length){a=0;for(var c=l.length;a<c;a++)l[a].className=l[a].className.replace(/\bRATIO-WIDESCREEN\b/i,""),e&&(l[a].className=l[a].className+" ratio-widescreen")}},setAspectImagesPlato5:function(e){var t=getElementsByClassName("custom_img_plato_5","img",!1);if(t.length)for(var a=0;a<t.length;a++){var n=e?t[a].src.replace(/\.jpg$/i,"_ws.jpg"):t[a].src.replace(/\_ws\.jpg$/i,".jpg");t[a].src=n}},customDesignApply:function(e,t,a,n,r){var o=getElementsByClassName("custom_img","img",!1);if(o.length){v();for(var i=0;i<o.length;i++){var s=o[i].getAttribute("data-default-src")?o[i].getAttribute("data-default-src"):o[i].src,l=s;e&&o[i].className.indexOf("skip_switch_design")<0&&(l=s.replace(/_[0-9]+-/gim,"_"+e+"-")),l=b(l,t),a&&0<=o[i].className.indexOf("custom_color_img_switch")&&(l=_(l,a)),o[i].setAttribute("data-default-src",l),o[i].src=s!=l?l:o[i].src;var c=o[i].getAttribute("data-preview-number");if(c)for(var d=1;d<=c;d++){var u=o[i].getAttribute("data-preview-"+d);if(!u)break;u=b(u=u.replace(/_[0-9]+-/gim,"_"+e+"-"),t),a&&1==d&&(u=_(u,a)),o[i].setAttribute("data-preview-"+d,u)}}var m=getElementsByClassName("switch_design_container",!1,!1);if(m.length)for(var g=0;g<m.length;g++)m[g].className=m[g].className.replace(/\bACTIVE\b/i,""),0<m[g].className.indexOf("design_"+e)&&(m[g].className=m[g].className+" active ");y(),function(e){var t="a"==e||"b"==e,a=getElementsByClassName("custom_title_image",!1,!1);if(a.length)for(var n=0;n<a.length;n++)a[n].className=t?a[n].className+(a[n].className.indexOf("show_backdrop")<=0?" show_backdrop ":""):a[n].className.replace(/\bSHOW_BACKDROP\b/i,"")}(n),function(e){var t=getElementsByClassName("artwork_container",!1,!1);if(t.length)for(var a=0;a<t.length;a++)t[a].className=!0===e||"1"===e?t[a].className+(t[a].className.indexOf("artworks")<=0?" artworks ":""):t[a].className.replace(/\bARTWORKS\b/i,"")}(r)}var f=getElementsByClassName("custom_design_link",!1,!1);if(f.length)for(var p=0;p<f.length;p++){var h=customUrl.replaceDesignInUrl(f[p].href,e);h=customUrl.replaceVersionNumberInUrl(h,""),f[p].href=h||f[p].href}"function"==typeof replaceDesignTitle&&replaceDesignTitle(e)},customDesignApplyColors:function(e,t,a,n){o(t,1),r(e,1),i(a,1),s(n,1),o(t,2),r(e,2),i(a,2),s(n,2),o(t,3),r(e,3),i(a,3),s(n,3)},setCurrentBackdropTransparency:y,replaceColorByClassAndPriorities:function(e,t){var a=getElementsByClassName(e,!1,!1);if(!a||!a.length)return!1;for(var n=0;n<a.length;n++)0<a[n].className.indexOf("custom_color_img_priority_1")&&imageEdit.replaceColor(a[n],t);setTimeout(function(){for(var e=0;e<a.length;e++)0<a[e].className.indexOf("custom_color_img_priority_2")&&imageEdit.replaceColor(a[e],t)},700),setTimeout(function(){for(var e=0;e<a.length;e++)a[e].className.indexOf("custom_color_img_priority_1")<0&&a[e].className.indexOf("custom_color_img_priority_2")<0&&imageEdit.replaceColor(a[e],t)},1100)}}}(),editCustomImages=function(){function a(){var e=document.getElementById("download_customizable_btn_main");if(!e){var t=getElementsByClassName("download_customizable_btn",!1,!1);if(t.length)for(var a=0;a<t.length;a++){e=t[a];break}}if(e){var n=e.getAttribute("data-color-ts-title-backdrop");if(n){var r=JSON.parse(n);customImages.replaceColorByClassAndPriorities("ts-bkd",r)}var o=e.getAttribute("data-color-artwork");if(o){r=JSON.parse(o);for(var i=getElementsByClassName("ts-art",!1,!1),s=0;s<i.length;s++)0<=i[s].className.indexOf("skip_switch_design")||imageEdit.replaceColor(i[s],r);setTimeout(function(){i=getElementsByClassName("bs-art",!1,!1);for(var e=0;e<i.length;e++)0<=i[e].className.indexOf("skip_switch_design")||imageEdit.replaceColor(i[e],r)},1e3)}var l=e.getAttribute("data-color-bs-title-backdrop");if(l){r=JSON.parse(l);customImages.replaceColorByClassAndPriorities("bs-title-bkd",r)}var c=e.getAttribute("data-color-bs-title-backdrop-slide-3");if(c){r=JSON.parse(c);customImages.replaceColorByClassAndPriorities("bs-title-bkd-s3",r)}var d=e.getAttribute("data-color-bs-non-title-backdrop");if(d){r=JSON.parse(d);customImages.replaceColorByClassAndPriorities("bs-content-bkd",r)}var u=e.getAttribute("data-color-bs-content-bkd-gradient");u&&customImages.replaceColorByClassAndPriorities("bs-content-bkd",u)}var m=getElementsByClassName("switch_design",!1,!1);if(m)for(a=0;a<m.length;a++){if(p=m[a].getAttribute("data-color-ts-artwork-by-design"))for(r=JSON.parse(p),i=getElementsByClassName("ts-art",!1,m[a]),s=0;s<i.length;s++)imageEdit.replaceColor(i[s],r)}var g=getElementsByClassName("switch_design",!1,!1);if(g)for(a=0;a<g.length;a++){if(p=g[a].getAttribute("data-color-bs-artwork-by-design"))for(r=JSON.parse(p),i=getElementsByClassName("bs-art",!1,g[a]),s=0;s<i.length;s++)imageEdit.replaceColor(i[s],r)}var f=getElementsByClassName("item_add_color",!1,!1);if(f)for(a=0;a<f.length;a++){var p;if(p=f[a].getAttribute("data-color-ts-add-color")){r=JSON.parse(p);imageEdit.replaceColor(f[a],r)}}}return{onLoadCheckCustomViewPageState:function(){if(document.getElementById("custom_trial_page_url"))return a();var e=document.getElementById("custom_view_page_url");if(!customState||!e)return!1;"function"==typeof history.pushState&&(window.onpopstate=function(e){customState.onpopstate(e)});var t=document.getElementById("is_page_dirty");t&&"1"==t.value?history.pushState&&(history.pushState(null,null,window.location.href),history.back()):(function(){if(!sessionStorage.length)return!1;var e=sessionStorage.getItem(window.location.href);if(!e)return!1;var t=!1;try{t=JSON.parse(e)}catch(e){}return!!t&&(customState.loadCustomParameters(t),!0)}()||a(),customState.replaceState(e.value)),t&&(t.value="1")}}}();function onLoadCheckCustomViewPageState(){return editCustomImages.onLoadCheckCustomViewPageState()}var imageEdit=function(){var r=[],I=[],i=[];function a(e,t){if(function(e,t){if(!e||!e.getAttribute("data-color-rgb"))return!1;var a=!1;try{a=JSON.parse(e.getAttribute("data-color-rgb"))}catch(e){a=!1}var n=o(e);if(!n||!e.getAttribute("data-white-image-url")||!e.getAttribute("data-default-src"))return!1;if(a&&Array.isArray(a)&&a[0]==t[0]&&a[1]==t[1]&&a[2]==t[2]&&n==e.getAttribute("data-white-image-url")&&e.src!==e.getAttribute("data-default-src"))return!0;return!1}(e,t))return!1;s(e)}function n(e,t){function a(){setTimeout(function(){e.removeEventListener("load",a,!1),function(e,t){s(e);var n=e.getAttribute("data-white-image-url");n=n||e.getAttribute("data-default-src");if(!n||!n.length||n.indexOf(".png",n.length-4)<0)return;if(r[n])return l(e,n,r[n],t);if(i[n])return i[n].push({imgElement:e,defaultSrc:n,colorsRGB:t});i[n]=i[n]?i[n]:new Array,i[n].push({imgElement:e,defaultSrc:n,colorsRGB:t}),function(r,o){var e=new XMLHttpRequest;e.onload=function(){var n=new FileReader;n.onloadend=function(){if(i[r]&&i[r].length)for(var e=0,t=i[r].length;e<t;e++){var a=i[r].pop();o(a.imgElement,n.result,a.colorsRGB)}},n.readAsDataURL(e.response)};var t=document.getElementById("custom_img_server_url"),a=r;t&&t.value&&(a=t.value+r);e.open("GET",a),e.setRequestHeader("X-PINGOTHER","pingpong"),e.setRequestHeader("Content-Type","application/xml"),e.setRequestHeader("Origin","https://powerpoint.crystalgraphics.com/"),e.setRequestHeader("Access-Control-Request-Method","GET"),e.setRequestHeader("Access-Control-Request-Headers","X-PINGOTHER, Content-Type"),e.responseType="blob",e.send()}(n,function(e,t,a){r[n]=e.src=t,setTimeout(function(){return l(e,n,t,a)},100)})}(e,t)},100)}e.complete?a():e.addEventListener("load",a)}function o(e){var t=e.getAttribute("data-default-src")?e.getAttribute("data-default-src"):e.src;return!!t&&(newImageUrl=t.replace(/-[0-9]+-/gim,"-45-"))}function s(e){var t;(t=e).className=t.className+" hide_while_loading";var a=o(e);e.setAttribute("data-white-image-url",a)}function l(e,t,a,n){return I[t+" "+n.toString()]?(e.src=I[t+" "+n.toString()],e.setAttribute("data-color-rgb",JSON.stringify(n)),C(e),!0):Array.isArray(n)?function(o,i,e,s){var l=document.createElement("canvas");o.src=e,l.width=o.naturalWidth,l.height=o.naturalHeight;var c=new Image;c.src=e,c.onload=function(){var e=l.getContext("2d");e.drawImage(c,0,0);for(var t=e.getImageData(0,0,l.width,l.height),a=t.data,n=0,r=a.length;n<r;n+=4)(0<a[n]||0<a[n+1]||0<a[n+2])&&(a[n]=Math.round(a[n]*s[0]/255),a[n+1]=Math.round(a[n+1]*s[1]/255),a[n+2]=Math.round(a[n+2]*s[2]/255));e.putImageData(t,0,0),o.src=l.toDataURL(),I[i+" "+s[0]+" "+s[1]+" "+s[2]]=o.src,o.setAttribute("data-color-rgb",JSON.stringify(s)),C(o)}}(e,t,a,n):"gradient_80"===n?function(d,u,e,m){var g=document.createElement("canvas");d.src=e,g.width=d.naturalWidth,g.height=d.naturalHeight;var f=new Image;f.src=e,f.onload=function(){var e=g.getContext("2d");e.drawImage(f,0,0);for(var t=e.getImageData(0,0,g.width,g.height),a=1,n=4*(1-190/255)/t.data.length,r=2,o=32/t.data.length,i=0,s=t.data.length;i<s;i+=4){a-=n,r+=o;var l=hslRgb.rgbToHsl(t.data[i],t.data[i+1],t.data[i+2]),c=hslRgb.hslToRgb(l[0],l[1],a);t.data[i]=c[0],t.data[i+1]=c[1],t.data[i+2]=c[2],t.data[i+3]=0<t.data[i+3]?Math.round(255-255*r/100):t.data[i+3]}d.style.opacity="1",e.putImageData(t,0,0),d.src=g.toDataURL(),I[u+" "+m.toString()]=d.src,d.setAttribute("data-color-rgb",m.toString()),C(d)}}(e,t,a,n):"gradient_23396"===n?function(b,_,e,w){var t=getElementsByClassName("download_customizable_btn",!1,!1);if(!t.length||!t[0]||!t[0].getAttribute("data-color-bs-content-bkd-gradient-color"))return!1;w=JSON.parse(t[0].getAttribute("data-color-ts-title-backdrop"));var k=document.createElement("canvas");b.src=e,k.width=b.naturalWidth,k.height=b.naturalHeight;var E=new Image;E.src=e,E.onload=function(){var e=k.getContext("2d");e.drawImage(E,0,0);for(var t=e.getImageData(0,0,k.width,k.height),a=w[0],n=a/t.width,r=a/t.height,o=w[1],i=o/t.width,s=o/t.height,l=w[2],c=l/t.width,d=l/t.height,u=(t.width,t.height,8/t.width),m=8/t.height,g=0,f=k.height;g<f;g++)for(var p=0,h=k.width;p<h;p++){t.data[4*(k.width*g+p)]=Math.round(a+(n*p+r*g)/2),t.data[4*(k.width*g+p)+1]=Math.round(o+(i*p+s*g)/2),t.data[4*(k.width*g+p)+2]=Math.round(l+(c*p+d*g)/2);var v=hslRgb.rgbToHsl(t.data[4*(k.width*g+p)],t.data[4*(k.width*g+p)+1],t.data[4*(k.width*g+p)+2]),y=hslRgb.hslToRgb(v[0],v[1],v[2]);t.data[4*(k.width*g+p)]=y[0],t.data[4*(k.width*g+p)+1]=y[1],t.data[4*(k.width*g+p)+2]=y[2],t.data[4*(k.width*g+p)+3]=0<t.data[4*(k.width*g+p)+3]?Math.round(253-(u*p+m*g)/2*255/100):t.data[4*(k.width*g+p)+3]}b.style.opacity="1",e.putImageData(t,0,0),b.src=k.toDataURL(),I[_+" "+w.toString()]=b.src,b.setAttribute("data-color-rgb",w.toString()),C(b)}}(e,t,a,n):"gradient_23396a"===n?function(i,s,e,l){var t=getElementsByClassName("download_customizable_btn",!1,!1);if(!t.length||!t[0]||!t[0].getAttribute("data-color-bs-content-bkd-gradient-color"))return!1;l=JSON.parse(t[0].getAttribute("data-color-ts-title-backdrop"));var c=JSON.parse(t[0].getAttribute("data-color-bs-title-backdrop-slide-3")),d=JSON.parse(t[0].getAttribute("data-color-ts-title-backdrop")),u=document.createElement("canvas");i.src=e,u.width=i.naturalWidth,u.height=i.naturalHeight;var m=new Image;m.src=e,m.onload=function(){var e=u.getContext("2d");e.drawImage(m,0,0);for(var t=e.getImageData(0,0,u.width,u.height),a=e.createLinearGradient(20,20,u.width,u.width),n=function(t,a,e){for(var n=1/(e-1),r=[],o=Object.keys(a).map(function(e){return[t[e]]}),i=Object.keys(t).map(function(e){return[a[e]]}),s=0;s<e;s++)r.push(g(o,i,n*s));return r}(c,d,5),r=1/n.length,o=0;o<n.length;o++)a.addColorStop(parseFloat(o*r),"rgb("+n[o][0]+","+n[o][1]+","+n[o][2]+")");i.style.opacity="0.8",e.putImageData(t,0,0),e.fillStyle=a,e.fillRect(30,0,u.width,u.height),i.src=u.toDataURL(),I[s+" "+l.toString()]=i.src,i.setAttribute("data-color-rgb",l.toString()),C(i)}}(e,t,a,n):void 0}function g(e,t,a){arguments.length<3&&(a=.5);for(var n=e.slice(),r=0;r<3;r++)n[r]=Math.round(parseInt(n[r])+parseFloat(a)*(parseInt(t[r])-parseInt(e[r])));return n}function C(e){setTimeout(function(){e.className=e.className.replace(/\bHIDE\_WHILE\_LOADING\b/gim,"")},100)}return{replaceColor:function(e,t){a(e,t),n(e,t)},replaceColorWithDelay:function(e,t){a(e,t),setTimeout(function(){n(e,t)},100)}}}(),ajaxSearch=function(){function makeAjaxRequest(){var e=_getAjaxRequestParams();if(!e)return!1;_prepareHtml(),_sendAjaxRequest(e)}function _prepareHtml(){document.body.parentNode.style.height="100%",document.body.parentNode.style.overflow="auto",document.body.style.height="100%",document.body.style.overflow="auto"}function _getAjaxRequestParams(){if(!document.getElementById("search_ajax_params_on_load"))return!1;var e=document.getElementById("search_ajax_url"),t=!(!e||!e.value)&&e.value;if(!t)return!1;var a=document.getElementById("search_ajax_params"),n=!(!a||!a.value)&&JSON.parse(a.value);return!!n&&t+Object.keys(n).map(function(e){return encodeURIComponent(e)+"="+encodeURIComponent(n[e])}).join("&")}function _sendAjaxRequest(e){_handleResponse("<div class='search-ajax-response-container-placeholder'></div>",!1);var t=new XMLHttpRequest;t.onload=function(){_handleResponse(t.responseText,!0)},t.onprogress=function(){_handleResponse(t.responseText,!1)},t.onreadystatechange=function(){3==t.readyState&&_handleResponse(t.responseText,!1)},t.open("GET",e),t.send(e),showProgressWithTimer(!0,3e4)}function _handleResponse(e,t){if(_setContent(e),_addEventListeners(),!t)return!1;truncateElementsWithDots(),history.pushState&&0<e.indexOf("pagination-container")&&(history.pushState({responseText:e},null,window.location.href),window.onpopstate=function(e){ajaxSearch.onpopstate(e)})}function _setContent(e){showProgress(!1);var t=document.getElementById("search_ajax_response_container");if(!t)return!1;t.innerHTML=e,loadLazy()}function _evalScriptTag(container){var scriptElements=container.getElementsByTagName("script");if(scriptElements)for(var i=0;i<scriptElements.length;i++)eval(scriptElements[i])}function _addEventListeners(){var e=getElementsByClassName("pagination_page_link",!1,!1);if(e.length)for(var t=0;t<e.length;t++)e[t].setAttribute("href","#"),addListener("click","processPaginationLinkClick",e[t].id,e[t].id);document.getElementById("edit_category_btn")&&"function"==typeof editButtonClickEvent&&addListener("click","editButtonClickEvent","edit_category_btn","edit_category_btn"),document.getElementById("submit_category_btn")&&"function"==typeof submitButtonClickEvent&&addListener("click","submitButtonClickEvent","submit_category_btn","submit_category_btn")}function onpopstate(e){"scrollRestoration"in history&&(history.scrollRestoration="manual"),e&&e.state&&e.state.responseText&&(_setContent(e.state.responseText),_addEventListeners())}function processPaginationLinkClick(e,t){t.preventDefault&&t.preventDefault(),t.returnValue=!1;var a=document.getElementById(e).getAttribute("data-page-url"),n=_getAjaxRequestParams();if(!n)return!1;var r=_getJsonFromUrl(a);return r&&(n="?"+n,Object.keys(r).forEach(function(e){n=setGetParameterToUrl(n,e,r[e])}),elmnt=document.getElementById("search_ajax_response_container"),elmnt&&scrollTo(document.body,elmnt.offsetTop-20,500),_sendAjaxRequest(n=(n=n.substring(1)).replace(/templates-cached/g,"templates"))),!1}function _getJsonFromUrl(e){var a={};return(e=0<e.indexOf("?")?e.split("?")[1]:"").split("&").forEach(function(e){if(e){var t=e.split("=");t[0]&&t[1]&&(a[t[0]]=decodeURIComponent(t[1]))}}),a}var publicAPI={makeAjaxRequest:makeAjaxRequest,processPaginationLinkClick:processPaginationLinkClick,processPaginationLinkClickCached:processPaginationLinkClickCached,onpopstate:onpopstate};return publicAPI}();function makeAjaxRequest(){return ajaxSearch.makeAjaxRequest()}function processPaginationLinkClick(e,t){return ajaxSearch.processPaginationLinkClick(e,t)}function processPaginationLinkClickCached(e,t){return ajaxSearch.processPaginationLinkClickCached(e,t)}var ajaxRelatedTemplates=function(){function t(){var e=function(){var e=document.getElementById("search_ajax_url"),t=!(!e||!e.value)&&e.value;if(!t)return!1;var a=document.getElementById("search_ajax_params"),n=!(!a||!a.value)&&JSON.parse(a.value);if(!n)return!1;var r=Object.keys(n).map(function(e){return encodeURIComponent(e)+"="+encodeURIComponent(n[e])}).join("&");return t+r}();if(!e)return!1;!function(e){a("<div class='search-ajax-response-container-placeholder'></div>",!1);var t=new XMLHttpRequest;t.onload=function(){a(t.responseText,!0)},t.onprogress=function(){a(t.responseText,!1)},t.onreadystatechange=function(){3==t.readyState&&a(t.responseText,!1)},t.open("GET",e),t.send(e)}(e)}function a(e,t){if(!function(e){showProgress(!1);var t=document.getElementById("search_ajax_response_container");if(!t)return;t.innerHTML=e}(e),!t)return!1}function n(){if(window.location.href&&-1<window.location.href.indexOf("/templates/view/")){var e=window.location.href.match(/\/templates\/view\/(\w*)\//);if(e&&e[1])return"/templates/view/"+e[1]}return window.location.href}return{makeAjaxRequest:t,onPageLoad:function(){if(!document.getElementById("search_ajax_url_on_load"))return!1;if(document.getElementById("search_ajax_url_on_load").getAttribute("data-setonpopstate")&&(window.onpopstate=function(e){customState.onpopstate(e)}),!cookiesFunc||!cookiesFunc.checkCookiesEnabled||!cookiesFunc.getCookie("search_keywords"))return!1;var e=cookiesFunc.getCookie("search_keywords");sessionStorage.getItem(n()+"_clear_search_words_"+e)?t():sessionStorage.setItem(n()+"_clear_search_words_"+e,"1")}}}();function ajaxRelatedTemplatesOnPageLoad(){return ajaxRelatedTemplates.onPageLoad()}var recaptcha=function(){function r(){if("undefined"!=typeof grecaptcha)return!1;var e=document.getElementsByTagName("head")[0],t=document.createElement("script");t.type="text/javascript",t.src="https://www.google.com/recaptcha/api.js?onload=loadCaptcha&render=explicit",t.src="https://www.google.com/recaptcha/api.js",e.appendChild(t)}return{signupEmailSubmitForm:function(e,t){!function(){r();var e=document.getElementById("recaptcha_placeholder");e&&(e.style.maxHeight="500px");var t=document.getElementById("signup_email_button_1");t&&(t.disabled=!0,t.className=t.className+" disabled")}();var a=document.getElementById("signup_email_input");if(!a)return t&&t.preventDefault&&t.preventDefault(),!1;if(!a.value)return showAlert("Please enter your email address. Thank you.",7),t&&t.preventDefault&&t.preventDefault(),!1;if(!/^[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,3}$/.test(a.value))return showAlert("The email address you entered does not appear to be a proper email address.<br /> Please enter a proper email address.  Thank you.",7),t&&t.preventDefault&&t.preventDefault(),!1;if("undefined"==typeof grecaptcha||!grecaptcha)return r(),t&&t.preventDefault&&t.preventDefault(),!1;var n=void 0!==grecaptcha.getResponse&&("undefined"==typeof recaptchaSubscribe?grecaptcha.getResponse():grecaptcha.getResponse(recaptchaSubscribe));return!(!n||0==n.length)||(showAlert('Please check the square to indicate you are "not a robot".<br /> Then please click the Sign Up button again. Thank you.',5),t&&t.preventDefault&&t.preventDefault(),!1)}}}();function signupEmailSubmitForm(e,t){return recaptcha.signupEmailSubmitForm(e,t)}function signupEmailSubmitFormOnSubmit(e){return recaptcha.signupEmailSubmitForm(!1,e)}function rotateWords(e){var t=document.getElementById(e),n=getElementsByClassName("rotate-word",!1,t);if(!n||n.length<2)return!1;var r=!1;setTimeout(function(){r=setInterval(function(){!function e(){var t=0;for(var a=0;a<n.length;a++)if(n[a].className&&0<n[a].className.indexOf("active")){if(n[a].className=n[a].className.replace(/\bACTIVE\b/i,""),(t=a>=n.length-1?0:a+1)>=n.length-1&&r){clearInterval(r),r=!1,setTimeout(function(){r=setInterval(function(){e()},1750)},5e3);break}break}n[t].className=n[t].className+" active"}()},1750)},1e3)}function rememberPowerplugsPage1ids(e){var t=e.getAttribute("data-ids"),a=e.getAttribute("data-search-term");if(!t||!a||!cookiesFunc.checkCookiesEnabled())return!1;cookiesFunc.setCookie("search-page-1-ids",t,3650),cookiesFunc.setCookie("search-page-1-term",a,3650)}function wrapTextToLine(e){if(!(e&&e.offsetHeight&&e.parentNode&&e.parentNode.offsetHeight))return!1;var t=!!e.getAttribute("data-max-height")&&e.getAttribute("data-max-height");for(fontSize=28;20<fontSize;fontSize--){if(!t&&e.offsetHeight<e.parentNode.offsetHeight||t&&e.offsetHeight<=t)return!1;e.style.fontSize=fontSize+"px"}"function"==typeof ellipsizeTextBox&&ellipsizeTextBox(e.id)}function wrapElementsTextToLine(){var e=getElementsByClassName("text_wrap_to_1_line",!1,!1);if(e.length)for(var t=0;t<e.length;t++)wrapTextToLine(e[t])}function truncateElementsWithDots(){var e=getElementsByClassName("truncate_with_dots",!1,!1);if(e.length)for(var t=0;t<e.length;t++)ellipsizeTextBox(e[t].id)}function openSharePopupDialog(e,t){var a=document.getElementById(e);return!(!a||!a.href)&&(window.open(a.href,"","menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600"),t.preventDefault&&t.preventDefault(),t.returnValue=!1)}function openFooterLinkPopupDialog(e,t){var a=document.getElementById(e);return!(!a||!a.href)&&(window.open(a.href,"","width=1200,height=800,toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=yes,copyhistory=no,resizable=yes"),t.preventDefault&&t.preventDefault(),t.returnValue=!1)}function onLoadupdateViewCounters(){if(!document||!document.referrer)return!1;document.getElementById("on_load_counter")&&document.getElementById("on_load_counter").getAttribute("data-counter-url")&&ajaxRequest.doHiddenRequest(document.getElementById("on_load_counter").getAttribute("data-counter-url")+"&ref="+encodeURI(document.referrer),!1)}function addListener(e,t,a,n){var r=document.getElementById(a);if(null==r||"function"!=typeof window[t])return!1;var o=window[t];switch(e){case"click":r.addEventListener?r.addEventListener("click",function(e){return o(n,e)},!0):r.attachEvent("onclick",function(e){return o(n,e)});break;case"change":r.addEventListener?r.addEventListener("change",function(e){return o(n,e)},!0):r.attachEvent("onchange",function(e){return o(n,e)});break;case"submit":r.addEventListener?r.addEventListener("submit",function(e){return o(n)},!0):r.attachEvent("onsubmit",function(e){return o(n,e)})}}var onDomReadyHandler={run:function(){showStartupMessage(),addPlaceHolder.checkPlaceholderSupport(),mobileCheck.onStartMobileCheck(),wrapElementsTextToLine(),addListener("click","toggle_visibility","menu_main_toggle","menu_main_container"),addListener("click","toggle_visibility","menu_products_link","submenu_products"),addListener("click","toggle_visibility","gear_menu_item","submenu_gear"),addListener("click","toggle_visibility","top_search_toggle","top_search"),addListener("click","toggle_visibility","category_main_toggle","category_main_container"),addListener("click","advancedSearch","advanced_search_link","search_form"),addListener("click","sendSubmit","search_form_button","search_form"),addListener("click","sendSubmit","search_form_button_adv","search_form2"),addListener("click","sendSubmit","search_form_button_bottom","search_form2"),addListener("submit","sendSubmit","search_form","search_form"),addListener("submit","sendSubmit","search_form2","search_form2"),addListener("click","enableCrystalTemplatesButtonClick","enable_crystal_templates","enable_crystal_templates");var e=getElementsByClassName("search_param_checkbox","input",!1);if(e.length)for(var t=0;t<e.length;t++)addListener("click","searchParamCheckboxClick",e[t].id,e[t].id);var a=getElementsByClassName("search_param_selectbox","select",!1);if(a.length)for(t=0;t<a.length;t++)addListener("change","searchParamSelectboxClick",a[t].id,a[t].id);var n=getElementsByClassName("sign_out",!1,!1);if(n.length)for(t=0;t<n.length;t++)addListener("click","logoutLinksClick",n[t].id,n[t].id);addListener("click","toggle_visibility","addtocarttable_howto_btn","addtocarttable_outer"),addListener("click","toggle_visibility","try_btn","submenu_products");var r=getElementsByClassName("js_switch_tab","input",!1);if(r.length)for(t=0;t<r.length;t++)addListener("click","switchTabs",r[t].id,r[t].id);var o=getElementsByClassName("close_dialog_btn",!1,!1);if(o.length)for(t=0;t<o.length;t++)addListener("click","closeModalDialog",o[t].id,o[t].id);var i=getElementsByClassName("opaco_closable",!1,!1);if(i.length)for(t=0;t<i.length;t++)addListener("click","closeModalDialog",i[t].id,i[t].id);addListener("click","noticeModalLinkClick","notice_menu_item","notice_menu_item"),addListener("click","notificationModalDismiss","notification_dismiss","notification_dismiss"),addListener("click","saveAspectRatioBtnClick","save_aspect_ratio_btn","save_aspect_ratio_btn");var s=getElementsByClassName("form_aspect_2",!1,!1);if(s.length)for(t=0;t<s.length;t++)addListener("click","saveAspectRatioBtnClick",s[t].id,s[t].id);addListener("click","setSearchToolFormat","format","format"),addListener("click","setSearchToolFormat","format_adv","format_adv");var l=getElementsByClassName("zoom_img","a",!1);if(l.length)for(t=0;t<l.length;t++)addListener("click","zoomImg",l[t].id,l[t].id);imagesPreloader.preloadImagesAfterLoad(),makeAjaxRequest(),ajaxRelatedTemplatesOnPageLoad(),addListener("click","templateFavorite","favorite_template_btn","favorite_template_btn");var c=getElementsByClassName("favorite_template_btn","input",!1);if(c.length)for(t=0;t<c.length;t++)addListener("click","templateFavorite",c[t].id,c[t].id);var d=getElementsByClassName("favorite_customizable_btn","a",!1);if(d.length)for(t=0;t<d.length;t++)addListener("click","customizableFavorite",d[t].id,d[t].id);var u=getElementsByClassName("download_customizable_btn","a",!1);if(u.length)for(t=0;t<u.length;t++)addListener("click","customizableDownload",u[t].id,u[t].id);var m=getElementsByClassName("favorite_template_btn","a",!1);if(m.length)for(t=0;t<m.length;t++)addListener("click","templateFavorite",m[t].id,m[t].id);var g=getElementsByClassName("download_template_btn","a",!1);if(g.length)for(t=0;t<g.length;t++)addListener("click","templateDownload",g[t].id,g[t].id);var f=getElementsByClassName("template-menu-button-noprint","a",!1);if(f.length)for(t=0;t<f.length;t++)addListener("click","templateDownload",f[t].id,f[t].id);var p=getElementsByClassName("template-menu-button-print","a",!1);if(p.length)for(t=0;t<p.length;t++)addListener("click","toggle_visibility",p[t].id,"templates_submenu_"+p[t].id);var h=getElementsByClassName("feedbackAnswerBtn","a",!1);if(h.length)for(t=0;t<h.length;t++)addListener("click","feedbackAnswer",h[t].id,h[t].id);addListener("click","feedbackTextHide","feedback_form_cancel","feedback_form_cancel"),addListener("click","sendFeedbackAnswer","feedback_form_submit","feedback_form_submit"),addListener("click","sendFeedbackAnswer","feedback_yes","feedback_yes");var v=getElementsByClassName("image_swithcher",!1,!1);if(v.length)for(t=0;t<v.length;t++)addListener("click","switchImage",v[t].id,v[t].id);addListener("click","hideAlert","alert_message_crystal","alert_message_crystal"),addListener("click","hideAlert","alert_message_text_crystal","alert_message_text_crystal"),addListener("click","customizableItemsLoad","more_customize_items_link","more_customize_items_link");var y=getElementsByClassName("position_button","input",!1);if(y.length)for(t=0;t<y.length;t++)addListener("click","changeImagePositionHandler",y[t].id,y[t].id),changeImagePositionEventHandler(y[t].id,!1);var b=getElementsByClassName("switch_design","a",!1);if(b.length)for(t=0;t<b.length;t++)addListener("click","switchCustomDesignEvt",b[t].id,b[t].id);addListener("change","switchCustomTitlePositionEvt","custom_title_position","custom_title_position"),addListener("click","undoPositionChanges","undo_position_confirmation_btn","undo_position_confirmation_btn"),window&&window.imageBlurryAlertOk&&"function"==typeof window.imageBlurryAlertOk&&addListener("click","imageBlurryAlertOk","image_blurry_btn_ok","image_blurry_btn_ok"),truncateElementsWithDots(),document.getElementById("rotate_words")&&rotateWords("rotate_words");var _=getElementsByClassName("share_popup_dialog",!1,!1);if(_.length)for(t=0;t<_.length;t++)addListener("click","openSharePopupDialog",_[t].id,_[t].id);var w=getElementsByClassName("footer_popup_wnd_link",!1,!1);if(w.length)for(t=0;t<w.length;t++)addListener("click","openFooterLinkPopupDialog",w[t].id,w[t].id);var k=document.getElementById("powerplugs_page_1_ids");k&&rememberPowerplugsPage1ids(k),"function"==typeof showFlashInstruction&&showFlashInstruction(),"function"==typeof onLoadCheckCustomViewPageState&&onLoadCheckCustomViewPageState(),"function"==typeof onLoadupdateViewCounters&&onLoadupdateViewCounters();var E=getElementsByClassName("ga_track_event_click",!1,!1);if(E.length)for(t=0;t<E.length;t++)console.log("+"),addListener("click","addToCartEventHandler",E[t].id,E[t].id);var I=document.querySelectorAll("#related_background_block img");if(I.length)for(t=0;t<I.length;t++)I[t].addEventListener("contextmenu",function(e){return e.preventDefault(),!1})}};if(document.addEventListener?"complete"==document.readyState||"loaded"==document.readyState||"interactive"==document.readyState?onDomReadyHandler.run():document.addEventListener("DOMContentLoaded",function(e){onDomReadyHandler.run()}):document.attachEvent&&document.attachEvent("onreadystatechange",function(){"complete"!=document.readyState&&"loaded"!=document.readyState&&"interactive"!=document.readyState||onDomReadyHandler.run()}),navigator.userAgent.match(/IEMobile\/10\.0/)){var msViewportStyle=document.createElement("style");msViewportStyle.appendChild(document.createTextNode("@-ms-viewport{width:auto!important}")),document.getElementsByTagName("head")[0].appendChild(msViewportStyle)}function displayAnswer(e){for(var t=e.parentElement.childNodes,a=0;a<t.length;a++)if("DIV"===t[a].tagName)return t[a].classList.contains("hideAnswer")?void t[a].classList.remove("hideAnswer"):void t[a].classList.add("hideAnswer")}function loadLazy(){if(isIE()){return;} var t=new IntersectionObserver(function(e,a){e.forEach(function(e){if(e.isIntersecting){var t=e.target;t.src=t.dataset.src,t.classList.remove("lazyload"),t.classList.add("lazyloaded"),a.unobserve(t)}})},{root:null});document.querySelectorAll("img.lazyload").forEach(function(e){t.observe(e)})}document.addEventListener("DOMContentLoaded",loadLazy),document.addEventListener("scroll",loadLazy),window.addEventListener("resize",loadLazy),window.addEventListener("orientationchange",loadLazy),window.addEventListener("transitionend",loadLazy),window.addEventListener("animationend",loadLazy),window.addEventListener("focus",loadLazy);
